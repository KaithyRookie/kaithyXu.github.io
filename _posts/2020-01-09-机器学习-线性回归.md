---
layout:     post
title:      çº¿æ€§å›å½’
subtitle:   çº¿æ€§å›å½’
date:       2020-01-09
author:     KaithyXu
header-img: img/linearRegression.jpg
catalog: true
tags:
    - Machine Learning
---

## çº¿æ€§å›å½’


### åŸç†

åœ¨ç»Ÿè®¡å­¦ä¸­ï¼Œçº¿æ€§å›å½’ï¼ˆè‹±èªï¼šlinear regressionï¼‰æ˜¯åˆ©ç”¨ç§°ä¸ºçº¿æ€§å›å½’æ–¹ç¨‹çš„æœ€å°å¹³æ–¹å‡½æ•¸å¯¹ä¸€ä¸ªæˆ–å¤šä¸ªè‡ªå˜é‡å’Œå› å˜é‡ä¹‹é—´å…³ç³»è¿›è¡Œå»ºæ¨¡çš„ä¸€ç§å›å½’åˆ†æã€‚è¿™ç§å‡½æ•°æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªç§°ä¸ºå›å½’ç³»æ•°çš„æ¨¡å‹å‚æ•°çš„çº¿æ€§ç»„åˆã€‚åªæœ‰ä¸€ä¸ªè‡ªå˜é‡çš„æƒ…å†µç§°ä¸ºç®€å•å›å½’ï¼Œå¤§äºä¸€ä¸ªè‡ªå˜é‡æƒ…å†µçš„å«åšå¤šå…ƒå›å½’ï¼ˆmultivariable linear regressionï¼‰ã€‚

æœ‰æ•°æ®é›†![](https://latex.codecogs.com/gif.latex?%5C%7B%28x_1%2Cy_1%29%2C%28x_2%2Cy_2%29%2C...%2C%28x_n%2Cy_n%29%5C%7D),å…¶ä¸­,![](https://latex.codecogs.com/gif.latex?x_i%20%3D%20%28x_%7Bi1%7D%3Bx_%7Bi2%7D%3Bx_%7Bi3%7D%3B...%3Bx_%7Bid%7D%29%2Cy_i%5Cin%20R) 
nè¡¨ç¤ºå˜é‡çš„æ•°é‡ï¼Œdè¡¨ç¤ºæ¯ä¸ªå˜é‡çš„ç»´åº¦ã€‚  
å¯ä»¥ç”¨ä»¥ä¸‹å‡½æ•°æ¥æè¿°yå’Œxä¹‹é—´çš„å…³ç³»ï¼š
å…¶ä¸€èˆ¬è¡¨è¾¾å¼å¦‚ä¸‹ï¼š
![](https://latex.codecogs.com/gif.latex?%5Cbegin%7Balign*%7D%20f%28x%29%20%26%3D%20%5Ctheta_0%20&plus;%20%5Ctheta_1x_1%20&plus;%20%5Ctheta_2x_2%20&plus;%20...%20&plus;%20%5Ctheta_dx_d%20%5C%5C%20%26%3D%20%5Csum_%7Bi%3D0%7D%5E%7Bd%7D%5Ctheta_ix_i%20%5C%5C%20%5Cend%7Balign*%7D)

ç”¨å‘é‡![](https://latex.codecogs.com/gif.latex?%5Ctheta)è¡¨ç¤ºæ‰€æœ‰ç³»æ•°ï¼Œè®­ç»ƒçš„ç›®çš„åœ¨äºç¡®å®šç³»æ•°![](https://latex.codecogs.com/gif.latex?%5Ctheta)ä»¥ä½¿å¾—f(x)å°½å¯èƒ½çš„æ¥è¿‘yçš„å€¼ã€‚
å‡æ–¹è¯¯å·®æ˜¯å›å½’ä¸­å¸¸ç”¨çš„æ€§èƒ½åº¦é‡ï¼Œå³:
![](https://latex.codecogs.com/gif.latex?J%28%5Ctheta%29%3D%5Cfrac%7B1%7D%7B2%7D%5Csum_%7Bj%3D1%7D%5E%7Bn%7D%28h_%7B%5Ctheta%7D%28x%5E%7B%28i%29%7D%29-y%5E%7B%28i%29%7D%29%5E2)

### æå¤§ä¼¼ç„¶ä¼°è®¡
ä¸ºä½•ä½¿ç”¨å‡æ–¹è¯¯å·®ä½œä¸ºæ€§èƒ½çš„åº¦é‡ï¼Œè¿™å¯ä»¥ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡ï¼Œä»æ¦‚ç‡çš„è§’åº¦æ¥è¯ é‡Šã€‚
å¯ä»¥å°†ç›®æ ‡å€¼ä¸å˜é‡å†™æˆå¦‚ä¸‹ç­‰å¼:
![](https://latex.codecogs.com/gif.latex?y%5E%7B%28i%29%7D%20%3D%20%5Ctheta%5ET%20x%5E%7B%28i%29%7D&plus;%5Cepsilon%5E%7B%28i%29%7D)

![](https://latex.codecogs.com/gif.latex?%5Cepsilon)è¡¨ç¤ºæˆ‘ä»¬æœªè§‚æµ‹åˆ°çš„å˜é‡çš„å°è±¡ï¼Œå³éšæœºå™ªéŸ³ã€‚æˆ‘ä»¬å‡å®š![](https://latex.codecogs.com/gif.latex?%5Cepsilon)æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒï¼Œæœä»é«˜æ–¯åˆ†å¸ƒã€‚ï¼ˆæ ¹æ®ä¸­å¿ƒæé™å®šç†ï¼‰
![](https://latex.codecogs.com/gif.latex?p%28%5Cepsilon%5E%7B%28i%29%7D%29%20%3D%20%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%7D%5Csigma%7Dexp%5Cleft%28-%5Cfrac%7B%28%5Cepsilon%5E%7B%28i%29%7D%29%5E2%7D%7B2%5Csigma%5E2%7D%5Cright%29)
å› æ­¤ï¼š
![](https://latex.codecogs.com/png.latex?p%28y%5E%7B%28i%29%7D%7Cx%5E%7B%28i%29%7D%3B%5Ctheta%29%20%3D%20%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%7D%5Csigma%7Dexp%5Cleft%28-%5Cfrac%7B%28y%5E%7B%28i%29%7D-%5Ctheta%5ET%20x%5E%7B%28i%29%7D%29%5E2%7D%7B2%5Csigma%5E2%7D%5Cright%29)
æˆ‘ä»¬å»ºç«‹æå¤§ä¼¼ç„¶å‡½æ•°ï¼Œå³æè¿°æ•°æ®éµä»å½“å‰æ ·æœ¬åˆ†å¸ƒçš„æ¦‚ç‡åˆ†å¸ƒå‡½æ•°ã€‚ç”±äºæ ·æœ¬çš„æ•°æ®é›†ç‹¬ç«‹åŒåˆ†å¸ƒï¼Œå› æ­¤å¯ä»¥å†™æˆ:
![](https://latex.codecogs.com/png.latex?L%28%5Ctheta%29%20%3D%20p%28%5Cvec%20y%20%7C%20X%3B%5Ctheta%29%20%3D%20%5Cprod%5En_%7Bi%3D1%7D%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%7D%5Csigma%7Dexp%5Cleft%28-%5Cfrac%7B%28y%5E%7B%28i%29%7D-%5Ctheta%5ET%20x%5E%7B%28i%29%7D%29%5E2%7D%7B2%5Csigma%5E2%7D%5Cright%29)

é€‰æ‹©![](https://latex.codecogs.com/gif.latex?%5Ctheta)ï¼Œä½¿å¾—ä¼¼ç„¶å‡½æ•°æœ€å¤§åŒ–ï¼Œè¿™å°±æ˜¯æå¤§ä¼¼ç„¶ä¼°è®¡çš„æ€æƒ³ã€‚

ä¸ºæ–¹ä¾¿è®¡ç®—ï¼Œé€šå¸¸å¯¹å¯¹æ•°ä¼¼ç„¶å‡½æ•°æ±‚æœ€å¤§å€¼:
![](https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%20l%28%5Ctheta%29%20%26%3D%20log%20L%28%5Ctheta%29%20%3D%20log%20%5Cprod%5En_%7Bi%3D1%7D%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%7D%5Csigma%7Dexp%5Cleft%28-%5Cfrac%7B%28y%5E%7B%28i%29%7D-%5Ctheta%5ET%20x%5E%7B%28i%29%7D%29%5E2%7D%20%7B2%5Csigma%5E2%7D%5Cright%29%20%5C%5C%20%26%20%3D%20%5Csum%5En_%7Bi%3D1%7Dlog%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%7D%5Csigma%7Dexp%5Cleft%28-%5Cfrac%7B%28y%5E%7B%28i%29%7D-%5Ctheta%5ET%20x%5E%7B%28i%29%7D%29%5E2%7D%7B2%5Csigma%5E2%7D%5Cright%29%20%5C%5C%20%26%20%3D%20nlog%5Cfrac%7B1%7D%7B%7B%5Csqrt%7B2%5Cpi%7D%5Csigma%7D%7D%20-%20%5Cfrac%7B1%7D%7B%5Csigma%5E2%7D%20%5Ccdot%20%5Cfrac%7B1%7D%7B2%7D%5Csum%5En_%7Bi%3D1%7D%28%28y%5E%7B%28i%29%7D-%5Ctheta%5ET%20x%5E%7B%28i%29%7D%29%5E2%20%5Cend%7Balign*%7D)

æ˜¾ç„¶ï¼Œæœ€å¤§åŒ–![](https://latex.codecogs.com/png.latex?l%28%5Ctheta%29)å³æœ€å°åŒ– ![](https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B2%7D%5Csum%5En_%7Bi%3D1%7D%28%28y%5E%7B%28i%29%7D-%5Ctheta%5ET%20x%5E%7B%28i%29%7D%29%5E2)

è¿™ä¸€ç»“æœå³å‡æ–¹è¯¯å·®ï¼Œå› æ­¤ç”¨è¿™ä¸ªå€¼ä½œä¸ºä»£ä»·å‡½æ•°æ¥ä¼˜åŒ–æ¨¡å‹åœ¨ç»Ÿè®¡å­¦çš„è§’åº¦æ˜¯åˆç†çš„ã€‚

ä¸­å¿ƒæé™å®šç†:æ¦‚ç‡è®ºä¸­çš„ä¸€ç»„å®šç†ï¼ŒæŒ‡åœ¨é€‚å½“çš„æ¡ä»¶ä¸‹ï¼Œå¤§é‡ç›¸äº’ç‹¬ç«‹çš„éšæœºå˜é‡çš„å‡å€¼ç»è¿‡é€‚å½“çš„æ ‡å‡†åŒ–åä¾åˆ†å¸ƒæ”¶æ•›äºæ­£å¤ªåˆ†å¸ƒ
é«˜æ–¯åˆ†å¸ƒ:åˆåæ­£æ€åˆ†å¸ƒï¼Œéµä»æ­£å¤ªåˆ†å¸ƒçš„æˆ‘éšæœºå˜é‡çš„æ¦‚ç‡ä¸ºå»é‚»è¿‘æœªçŸ¥å‚æ•°çš„å€¼çš„æ¦‚ç‡å¤§ï¼Œè¿œçš„å€¼çš„æ¦‚ç‡å°
![](img/normal_distribution.png)


### çº¿æ€§å›å½’æŸå¤±å‡½æ•°ã€ä»£ä»·å‡½æ•°ã€ç›®æ ‡å‡½æ•°
* æŸå¤±å‡½æ•°(Loss Function)ï¼šåº¦é‡å•æ ·æœ¬é¢„æµ‹çš„é”™è¯¯ç¨‹åº¦ï¼ŒæŸå¤±å‡½æ•°å€¼è¶Šå°ï¼Œæ¨¡å‹å°±è¶Šå¥½ã€‚
* ä»£ä»·å‡½æ•°(Cost Function)ï¼šåº¦é‡å…¨éƒ¨æ ·æœ¬é›†çš„å¹³å‡è¯¯å·®ã€‚
* ç›®æ ‡å‡½æ•°(Object Function)ï¼šä»£ä»·å‡½æ•°å’Œæ­£åˆ™åŒ–å‡½æ•°ï¼Œæœ€ç»ˆè¦ä¼˜åŒ–çš„å‡½æ•°ã€‚
* 
å¸¸ç”¨çš„æŸå¤±å‡½æ•°åŒ…æ‹¬ï¼š0-1æŸå¤±å‡½æ•°ã€å¹³æ–¹æŸå¤±å‡½æ•°ã€ç»å¯¹æŸå¤±å‡½æ•°ã€å¯¹æ•°æŸå¤±å‡½æ•°ç­‰ï¼›å¸¸ç”¨çš„ä»£ä»·å‡½æ•°åŒ…æ‹¬å‡æ–¹è¯¯å·®ã€å‡æ–¹æ ¹è¯¯å·®ã€å¹³å‡ç»å¯¹è¯¯å·®ç­‰ã€‚

### çº¿æ€§å›å½’çš„ä¼˜åŒ–æ–¹æ³•
1. éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•
è®¾å®šåˆå§‹å‚æ•°![](https://latex.codecogs.com/gif.latex?%5Ctheta)ï¼Œä½¿å¾—![](https://latex.codecogs.com/png.latex?J%28%5Ctheta%29)æœ€å°åŒ–: ![](https://latex.codecogs.com/png.latex?%5Ctheta_j%3A%3D%5Ctheta_j-%5Calpha%5Cfrac%7B%5Cpartial%7BJ%28%5Ctheta%29%7D%7D%7B%5Cpartial%5Ctheta%7D)

![](https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%20%5Cfrac%7B%5Cpartial%7BJ%28%5Ctheta%29%7D%7D%7B%5Cpartial%5Ctheta%7D%20%26%3D%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%5Ctheta_j%7D%5Cfrac%7B1%7D%7B2%7D%5Csum_%7Bi%3D1%7D%5E%7Bn%7D%28f_%5Ctheta%28x%29%5E%7B%28i%29%7D-y%5E%7B%28i%29%7D%29%5E2%20%5C%5C%20%26%3D%202*%5Cfrac%7B1%7D%7B2%7D%5Csum_%7Bi%3D1%7D%5E%7Bn%7D%28f_%5Ctheta%28x%29%5E%7B%28i%29%7D-y%5E%7B%28i%29%7D%29*%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%5Ctheta_j%7D%28f_%5Ctheta%28x%29%5E%7B%28i%29%7D-y%5E%7B%28i%29%7D%29%20%5C%5C%20%26%3D%20%5Csum_%7Bi%3D1%7D%5E%7Bn%7D%28f_%5Ctheta%28x%29%5E%7B%28i%29%7D-y%5E%7B%28i%29%7D%29*%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%5Ctheta_j%7D%28%5Csum_%7Bj%3D0%7D%5E%7Bd%7D%5Ctheta_jx_j%5E%7B%28i%29%7D-y%5E%7B%28i%29%7D%29%29%5C%5C%20%26%3D%20%5Csum_%7Bi%3D1%7D%5E%7Bn%7D%28f_%5Ctheta%28x%29%5E%7B%28i%29%7D-y%5E%7B%28i%29%7D%29x_j%5E%7B%28i%29%7D%20%5C%5C%20%5Cend%7Balign*%7D)

å³:
![](https://latex.codecogs.com/png.latex?%5Ctheta_j%20%3D%20%5Ctheta_j%20&plus;%20%5Calpha%5Csum_%7Bi%3D1%7D%5E%7Bn%7D%28y%5E%7B%28i%29%7D-f_%5Ctheta%28x%29%5E%7B%28i%29%7D%29x_j%5E%7B%28i%29%7D)
å…¶ä¸­ï¼Œä¸‹æ ‡jè¡¨ç¤ºç¬¬jä¸ªå‚æ•°ï¼Œä¸Šæ ‡iè¡¨ç¤ºç¬¬iä¸ªæ•°æ®ç‚¹ã€‚

å°†æ‰€æœ‰çš„å‚æ•°ä»¥å‘é‡å½¢å¼è¡¨ç¤ºï¼Œå¯å¾—ï¼š
![](https://latex.codecogs.com/png.latex?%5Ctheta%20%3D%20%5Ctheta%20&plus;%20%5Calpha%5Csum_%7Bi%3D1%7D%5E%7Bn%7D%28y%5E%7B%28i%29%7D-f_%5Ctheta%28x%29%5E%7B%28i%29%7D%29x%5E%7B%28i%29%7D)

åœ¨éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•ä¸­ï¼Œæ¯æ¬¡éšæœºé€‰æ‹©ä¸€ä¸ªæ ·æœ¬æ ¹æ®å‡½æ•°è®¡ç®—æœ€æ–°çš„![](https://latex.codecogs.com/gif.latex?%5Ctheta)ï¼Œå³:
![](https://latex.codecogs.com/png.latex?%5Ctheta%20%3D%20%5Ctheta%20&plus;%20%5Calpha%28y%5E%7B%28i%29%7D-f_%5Ctheta%28x%29%5E%7B%28i%29%7D%29x%5E%7B%28i%29%7D)
å¹¶è®¡ç®—![](https://latex.codecogs.com/png.latex?f%28x%29%5E%7B%28i%29%7D) ä¸![](https://latex.codecogs.com/png.latex?y%5E%7B%28i%29%7D)çš„è¯¯å·®çš„å¹³æ–¹

ä¼˜ç‚¹: å½“æ•°æ®ç‚¹è¶³å¤Ÿå¤šçš„æ—¶å€™ï¼Œå…è®¸æ•ˆç‡æ›´é«˜
ç¼ºç‚¹: å› ä¸ºæ¯æ¬¡åªé’ˆå¯¹ä¸€ä¸ªæ ·æœ¬æ›´æ–°å‚æ•°ï¼Œæœªå¿…æ‰¾åˆ°æœ€å¿«è·¯å¾„è¾¾åˆ°æœ€ä¼˜å€¼ï¼Œç”šè‡³æœ‰æ—¶å€™ä¼šå‡ºç°å‚æ•°åœ¨æœ€å°å€¼é™„è¿‘å¾˜å¾Šè€Œä¸æ˜¯ç«‹å³æ”¶æ•›

å½“æ•°æ®é‡å¾ˆå¤§çš„æ—¶å€™ï¼Œéšæœºæ¢¯åº¦ä¸‹é™æ³•ç»å¸¸ä¼˜äºæ‰¹æ¢¯åº¦ä¸‹é™æ³•

æ¢¯åº¦ä¸‹é™æ³•çš„ç¼ºé™·åœ¨äºå½“å‡½æ•°ä¸ºéå‡¸å‡½æ•°æ—¶ï¼Œæœ‰å¯èƒ½æ‰¾åˆ°çš„å¹¶éå…¨å±€æœ€ä¼˜å€¼ï¼Œè€Œæ˜¯å±€éƒ¨æœ€ä¼˜å€¼

2. æœ€å°äºŒä¹˜æ³•çŸ©é˜µæ±‚è§£
ä»¤:
![](https://latex.codecogs.com/png.latex?X%20%3D%20%5Cleft%5B%20%5Cbegin%7Barray%7D%20%7Bcccc%7D%20%28x%5E%7B%281%29%7D%29%5ET%5C%5C%20%28x%5E%7B%282%29%7D%29%5ET%5C%5C%20%5Cldots%20%5C%5C%20%28x%5E%7B%28n%29%7D%29%5ET%20%5Cend%7Barray%7D%20%5Cright%5D)

å…¶ä¸­:
![](https://latex.codecogs.com/png.latex?x%5E%7B%28i%29%7D%20%3D%20%5Cleft%5B%20%5Cbegin%7Barray%7D%20%7Bcccc%7D%20x_1%5E%7B%28i%29%7D%5C%5C%20x_2%5E%7B%28i%29%7D%5C%5C%20%5Cldots%20%5C%5C%20x_d%5E%7B%28i%29%7D%20%5Cend%7Barray%7D%20%5Cright%5D)

ç”±äº:
![](https://latex.codecogs.com/png.latex?Y%20%3D%20%5Cleft%5B%20%5Cbegin%7Barray%7D%20%7Bcccc%7D%20y%5E%7B%281%29%7D%5C%5C%20y%5E%7B%282%29%7D%5C%5C%20%5Cldots%20%5C%5C%20y%5E%7B%28n%29%7D%20%5Cend%7Barray%7D%20%5Cright%5D)

![](https://latex.codecogs.com/png.latex?h_%5Ctheta%28x%29)å¯ä»¥å†™ä½œ![](https://latex.codecogs.com/png.latex?h_%5Ctheta%28x%29%3DX%5Ctheta)

å¯¹äºå‘é‡æ¥è¯´ï¼Œæœ‰![](https://latex.codecogs.com/png.latex?z%5ETz%20%3D%20%5Csum_i%20z_i%5E2)
å› æ­¤å¯ä»¥æŠŠæŸå¤±å‡½æ•°å†™ä½œ
![](https://latex.codecogs.com/png.latex?J%28%5Ctheta%29%3D%5Cfrac%7B1%7D%7B2%7D%28X%5Ctheta-Y%29%5ET%28X%5Ctheta-Y%29)

ä¸ºæœ€å°åŒ–![](https://latex.codecogs.com/png.latex?J%28%5Ctheta%29),å¯¹![](https://latex.codecogs.com/png.latex?%5Ctheta)æ±‚å¯¼å¯å¾—ï¼š
![](https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%20%5Cfrac%7B%5Cpartial%7BJ%28%5Ctheta%29%7D%7D%7B%5Cpartial%5Ctheta%7D%20%26%3D%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%5Ctheta%7D%20%5Cfrac%7B1%7D%7B2%7D%28X%5Ctheta-Y%29%5ET%28X%5Ctheta-Y%29%20%5C%5C%20%26%3D%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%5Ctheta%7D%20%28%5Ctheta%5ETX%5ETX%5Ctheta%20-%20Y%5ETX%5Ctheta-%5Ctheta%5ET%20X%5ETY%20-%20Y%5ETY%29%20%5C%5C%20%5Cend%7Balign*%7D)

ä¸­é—´ä¸¤é¡¹äº’ä¸ºè½¬ç½®ï¼Œç”±äºæ±‚å¾—çš„å€¼æ˜¯ä¸ªæ ‡é‡ï¼ŒçŸ©é˜µä¸è½¬ç½®ç›¸åŒï¼Œå› æ­¤å¯ä»¥å†™æˆ
![](https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%20%5Cfrac%7B%5Cpartial%7BJ%28%5Ctheta%29%7D%7D%7B%5Cpartial%5Ctheta%7D%20%26%3D%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%5Ctheta%7D%20%28%5Ctheta%5ETX%5ETX%5Ctheta%20-%202%5Ctheta%5ET%20X%5ETY%20-%20Y%5ETY%29%20%5C%5C%20%5Cend%7Balign*%7D)
ä»¤åå¯¼æ•°ç­‰äºé›¶ï¼Œç”±äºæœ€åä¸€é¡¹å’Œ ğœƒ æ— å…³ï¼Œåå¯¼æ•°ä¸º0
å› æ­¤:
![](https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%7BJ%28%5Ctheta%29%7D%7D%7B%5Cpartial%5Ctheta%7D%20%3D%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%5Ctheta%7D%20%5Ctheta%5ETX%5ETX%5Ctheta%20-%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%5Ctheta%7D%20%5Ctheta%5ET%20X%5ETY)
åˆ©ç”¨çŸ©é˜µæ±‚å¯¼æ€§è´¨,![](https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20%5Cvec%20x%5ET%5Calpha%7D%7B%5Cpartial%20%5Cvec%20x%7D%20%3D%5Calpha)å’Œ
![](https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20A%5ETB%7D%7B%5Cpartial%20%5Cvec%20x%7D%20%3D%20%5Cfrac%7B%5Cpartial%20A%5ET%7D%7B%5Cpartial%20%5Cvec%20x%7DB%20&plus;%20%5Cfrac%7B%5Cpartial%20B%5ET%7D%7B%5Cpartial%20%5Cvec%20x%7DA)

![](https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%5Ctheta%7D%20%5Ctheta%5ETX%5ETX%5Ctheta%20%26%3D%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%5Ctheta%7D%7B%28X%5Ctheta%29%5ETX%5Ctheta%7D%5C%5C%20%26%3D%20%5Cfrac%7B%5Cpartial%20%28X%5Ctheta%29%5ET%7D%7B%5Cpartial%5Ctheta%7DX%5Ctheta%20&plus;%20%5Cfrac%7B%5Cpartial%20%28X%5Ctheta%29%5ET%7D%7B%5Cpartial%5Ctheta%7DX%5Ctheta%20%5C%5C%20%26%3D%202X%5ETX%5Ctheta%20%5Cend%7Balign*%7D)

![](https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%7BJ%28%5Ctheta%29%7D%7D%7B%5Cpartial%5Ctheta%7D%20%3D%20X%5ETX%5Ctheta%20-%20X%5ETY)
ä»¤å¯¼æ•°ç­‰äºé›¶ï¼Œ![](https://latex.codecogs.com/png.latex?%5Ctheta%20%3D%20%28X%5ETX%29%5E%7B%28-1%29%7DX%5ETY)

### ä»£ç å®ç°

```python
#ç”Ÿæˆæ•°æ®
import numpy as np
#ç”Ÿæˆéšæœºæ•°
np.random.seed(1234)
x = np.random.rand(500,3)
#æ„å»ºæ˜ å°„å…³ç³»ï¼Œæ¨¡æ‹ŸçœŸå®çš„æ•°æ®å¾…é¢„æµ‹å€¼,æ˜ å°„å…³ç³»ä¸ºy = 4.2 + 5.7*x1 + 10.8*x2ï¼Œå¯è‡ªè¡Œè®¾ç½®å€¼è¿›è¡Œå°è¯•
y = x.dot(np.array([4.2,5.7,10.8]))
```

1. æœ€å°äºŒä¹˜æ³•çš„çŸ©é˜µæ±‚è§£ï¼š

```python
class LR_LS():
    def __init__(self):
        self.w = None      
    def fit(self, X, y):
        # æœ€å°äºŒä¹˜æ³•çŸ©é˜µæ±‚è§£
        #============================= show me your code =======================
        # Xè¿›è¡Œè½¬ç½®ä¸ºåˆ—å‘é‡
        XT = X.transpose()
        
        # è®¡ç®—å‘é‡Xä¸Xè½¬ç½®çŸ©é˜µä¹˜ç§¯çš„é€†
        XXT_Inv = np.linalg.inv(XT.dot(X))
        
        # è®¡ç®—Xçš„è½¬ç½®ä¸yçš„ä¹˜ç§¯
        XTy = XT.dot(y)
        
        self.w = XXT_Inv.dot(XTy)
        #============================= show me your code =======================
    def predict(self, X):
        # ç”¨å·²ç»æ‹Ÿåˆçš„å‚æ•°å€¼é¢„æµ‹æ–°è‡ªå˜é‡
        #============================= show me your code =======================
        
        y_pred = X.dot(self.w)
        #============================= show me your code =======================
        return y_pred

if __name__ == "__main__":
    lr_ls = LR_LS()
    lr_ls.fit(x,y)
    print("ä¼°è®¡çš„å‚æ•°å€¼ï¼š%s" %(lr_ls.w))
    x_test = np.array([2,4,5]).reshape(1,-1)
    print("é¢„æµ‹å€¼ä¸º: %s" %(lr_ls.predict(x_test)))


```

2. éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•å®ç°

```python
class LR_GD():
    def __init__(self):
        self.w = None     
    def fit(self,X,y,alpha=0.02,loss = 1e-10): # è®¾å®šæ­¥é•¿ä¸º0.002,åˆ¤æ–­æ˜¯å¦æ”¶æ•›çš„æ¡ä»¶ä¸º1e-10
        y = y.reshape(-1,1) #é‡å¡‘yå€¼çš„ç»´åº¦ä»¥ä¾¿çŸ©é˜µè¿ç®—
        [m,d] = np.shape(X) #è‡ªå˜é‡çš„ç»´åº¦
        self.w = np.zeros((d)) #å°†å‚æ•°çš„åˆå§‹å€¼å®šä¸º0
        tol = 1e5
        #============================= show me your code =======================
        while tol > loss:
            # here
            #è·å–éšæœºæ ·æœ¬
            rand = np.random.randint(0,m,1)
            
            #è®¡ç®—éšæœºæ ·æœ¬çš„é¢„æµ‹ç»“æœ
            rp = X[rand].dot(self.w)
            
            #æ ¹æ®ç®—æ³•æ›´æ–°ğœƒ
            self.w = self.w + alpha * (y[rand] - rp)*X[rand]
            
            #å°†ğœƒè½¬ç½®ä¸ºåˆ—å‘é‡
            self.w = np.sum(self.w,axis=0)
            
            #æ ¹æ®æ–°çš„ä¼°è®¡å‚æ•°å€¼è®¡ç®—è¯¯å·®å¹³æ–¹å’Œ
            tol = (rp - y[rand])**2
        #============================= show me your code =======================
    def predict(self, X):
        # ç”¨å·²ç»æ‹Ÿåˆçš„å‚æ•°å€¼é¢„æµ‹æ–°è‡ªå˜é‡
        y_pred = X.dot(self.w)
        return y_pred  

if __name__ == "__main__":
    lr_gd = LR_GD()
    lr_gd.fit(x,y)
    print("ä¼°è®¡çš„å‚æ•°å€¼ä¸ºï¼š%s" %(lr_gd.w))
    x_test = np.array([2,4,5]).reshape(1,-1)
    print("é¢„æµ‹å€¼ä¸ºï¼š%s" %(lr_gd.predict(x_test)))


```

### å‚è€ƒæ–‡çŒ®
ğŸ‘‰[ç»´åŸºç™¾ç§‘-ä¸­å¿ƒæé™å®šç†](https://zh.wikipedia.org/wiki/%E4%B8%AD%E5%BF%83%E6%9E%81%E9%99%90%E5%AE%9A%E7%90%86)

ğŸ‘‰[ä¸­å¿ƒæé™å®šç†é€šä¿—ä»‹ç»](https://zhuanlan.zhihu.com/p/25241653)

ğŸ‘‰[æå¤§ä¼¼ç„¶ä¼°è®¡](https://www.jianshu.com/p/e0eb4f4ccf3e)

ğŸ‘‰[æ·±å…¥ç†è§£æœºå™¨å­¦ä¹ ä¸­çš„ï¼šç›®æ ‡å‡½æ•°ï¼ŒæŸå¤±å‡½æ•°å’Œä»£ä»·å‡½æ•°](https://blog.csdn.net/qq_28448117/article/details/79199835)